# Setup ----
library(devtools)
install_github("https://github.com/OB7-IRD/fishi.git",
               build_opts = c("--no-resave-data", "--no-manual"))
library(fishi)

# Configuration file ----
config_file <- furdeb::configuration_file(new_configtype = FALSE,
                                          path_configtype = "D:\\IRD\\5-Projets_&_themes\\12-Indicateurs\\2-Data\\configfile_indicators.csv")

# Database connections ----
t3_connection <- furdeb::db_connection(db_user = config_file[["t3plus_user"]],
                                       db_password = config_file[["t3plus_password"]],
                                       db_dbname = config_file[["t3plus_dbname"]],
                                       db_host = config_file[["t3plus_host"]],
                                       db_port = config_file[["t3plus_port"]])
avdth_connection <- furdeb::access_dbconnection(driver_name = "access_jdbc42",
                                                access_db_loc = config_file[["access_db_loc"]])

# Modifications of DESCRITPION file ----
# From CRAN
#usethis::use_package("DBI", type = 'Imports', min_version = TRUE)
# For add pipe (for dplyr) in the package
#usethis::use_pipe()
# From GitHub
#usethis::use_dev_package("toolbox", type = "Imports")
# Package code styoe checking ----
#lintr::lint_package()

# Indicators testing ----
# avdth_nb_landing_year_fleet_ocean
tmp1 <- avdth_nblanding_year_fleet_ocean(avdth_con = avdth_connection,
                                         year = 2017,
                                         fleet = c(1, 41),
                                         ocean = 1,
                                         fleet_name = "french fleet")
# avdth_nbset_fishingmode_year_fleet_ocean
tmp2 <- avdth_nbset_fishingmode_year_fleet_ocean(avdth_con = avdth_connection,
                                                 year = 2017,
                                                 fleet = c(1, 41),
                                                 ocean = 1,
                                                 fleet_name = "french fleet")
# avdth_catches_sp_fishingmode_year_fleet_ocean
tmp3 <- avdth_catches_sp_fishingmode_year_fleet_ocean(avdth_con = avdth_connection,
                                                      year = 2017,
                                                      fleet = c(1, 41),
                                                      ocean = 1,
                                                      fleet_name = "french fleet",
                                                      fishing_mode = 1)
tmp4 <- avdth_catches_sp_fishingmode_year_fleet_ocean(avdth_con = avdth_connection,
                                                      year = 2017,
                                                      fleet = c(1, 41),
                                                      ocean = 1,
                                                      fleet_name = "french fleet",
                                                      fishing_mode = 1,
                                                      specie = c("ALB", "BLT"))

# avdth_prcwellsample_year_fleet_ocean
tmp5 <- avdth_wellsample_year_fleet_ocean(avdth_con = avdth_connection,
                                          year = 2017,
                                          fleet = c(1, 41),
                                          ocean = 1,
                                          fleet_name = "french fleet",
                                          percentage = T)
tmp6 <- avdth_wellsample_year_fleet_ocean(avdth_con = avdth_connection,
                                          year = 2017,
                                          fleet = c(1, 41),
                                          ocean = 1,
                                          fleet_name = "french fleet",
                                          percentage = F)
# avdth_nblengthsample_year_fleet_ocean
tmp7 <- avdth_nblengthsample_year_fleet_ocean(avdth_con = avdth_connection,
                                              year = 2017,
                                              fleet = c(1, 41),
                                              ocean = 1,
                                              fleet_name = "french fleet")
