---
title: "Introduction to fishi"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to fishi}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, message = FALSE, warning = FALSE, include = FALSE}
library(fishi)
library(codama)
library(furdeb)
library(readxl)
library(readr)
library(kableExtra)

# Database connection
config <- configuration_file(path_file = paste0(path.expand("~"),"/.appconfig/indicator_glossary/configuration_file_fishi.yml"),
                             silent = TRUE)
balbaya_con <- postgresql_dbconnection(db_user = config[["databases_configuration"]][["balbaya_vmot5"]][["login"]],
                                                          db_password = config[["databases_configuration"]][["balbaya_vmot5"]][["password"]],
                                                          db_dbname = config[["databases_configuration"]][["balbaya_vmot5"]][["dbname"]],
                                                          db_host = config[["databases_configuration"]][["balbaya_vmot5"]][["host"]],
                                                          db_port = config[["databases_configuration"]][["balbaya_vmot5"]][["port"]])
```

# List of all the indicators

## Biologic

**bio_size_tuna**() : Size distribution of major tuna catches in percentage of the total number of fishes.

**bio_weight_tuna**() : weight distribution of major tuna catches in percentage of the total number of fishes.

## Catches

**fishery_production**() : total fishery production. Catch by species of the French purse seine fishing fleet.

**catch_per_searching_day**() : Annual number of catch per positive set on FOB-associated and free-swimming schools.

**catch_per_unit_effort**() : Annual catch rates (in t per searching day) on FOB- associated and free-swimming tuna schools (FSC).

**map_catch_distribution**() : Spatial distribution of tuna catches.

## Effort

**fishing_effort**() : Changes in nominal effort over time. Annual total number of fishing and searching days.

**map_effort_distribution**() : Spatial distribution of tuna effort.

**set_per_searching_day**() : Annual number of sets per searching day on FOB-associated and free-swimming schools

**spatial_occupancy**() : Changes in the spatial extent of the fishery over time. Annual number of 1-degree squares explored by each vessel.

**fishing_activity**() : Fishing operations. Annual number of fishing sets on FOB- associated and free-swimming tuna schools.

**fishing_capacity**() : Fishing capacity. Annual changes in the number of purse seiners by tonnage categories (barplots) and total carrying capacity (dashed line with circles).

# 

# Arguments

All the fishi indicators work in the same way. Each function has several arguments :

-   **data_connection:** connection to the database of your choice, it must be a list [database name, database connection link].

-   **time_period:** the time period selected for the indicator

-   **ocean:** code for the ocean of your choice (cf referentials)

-   **country:** code for the country of your choice (cf referentials)

-   **graph_type:** plot or plotly for a dynamic figure

-   **vessel_type_select:** to select the precision of the vessels

-   **vessel_type:** vessel code (for seiners, if vessel_type_select = "engin" choose 1, if vessel_type_select = "vessel_type" choose 4, 5, 6.

# 

# Example :

For each indicator, all the arguments can be modified as required. Take fishing_capacity, for example, to obtain a graph of the Atlantic Ocean between 1991 and 2022 and a second graph of the Indian Ocean between 1981 and 2022. The arguments to change are time_period and ocean.

#### Fishing capacity : Atlantic Ocean, 1991-2022

```{r, message=FALSE, warning=FALSE, fig.width = 8, fig.height = 8}
fishing_capacity(data_connection = balbaya_con,
                 time_period = as.integer(c(1991:2022)), 
                 ocean = as.integer(1),
                 graph_type = "plot",
                 vessel_type_select = "vessel_type",
                 vessel_type = as.integer(x = c(4, 5, 6)),
                 figure = "vessel")
```

#### 

#### Fishing capacity : Indian ocean, 1981-2022

```{r, message=FALSE, warning=FALSE, fig.width = 8, fig.height = 8}
fishing_capacity(data_connection = balbaya_con,
                 time_period = as.integer(c(1981:2022)), 
                 ocean = as.integer(2),
                 graph_type = "plot",
                 vessel_type_select = "vessel_type",
                 vessel_type = as.integer(x = c(4, 5, 6)),
                 figure = "vessel")
```
